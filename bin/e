#!/bin/bash

# filename=$( echo $1 | tr "[:upper:]" "[:lower:]" )

# FILE can be either just a FILENAME or [+LINE[:COLUMN]] FILENAME.
filename="$@"

case $filename in
    *.doc|*.odp|*.ppt|*.ods|*.xls|*.odt) exec libreoffice --nologo "$filename";;

    *)
        if [[ "$filename" =~ ^([^:]*):?([:0-9]*)$  ]]; then
            filename="${BASH_REMATCH[1]}"
            if [[ -n "${BASH_REMATCH[2]}" ]]; then
                linecol="+${BASH_REMATCH[2]}"
            else
                linecol=
            fi
        fi

	if emacsclient --no-wait $linecol "$filename" > /dev/null 2>&1; then
	    emacsclient --eval '(raise-frame)'
	    echo Sent to existing emacs
	else
	    echo Launching new emacs
	    exec emacs "$filename" &
	fi
	;;
esac
